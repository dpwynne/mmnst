theta.function<-function(t,theta,t.start,resolution) theta[(1+floor((t-t.start)/resolution))]
##pull the value of the intensity function that corresponds to a particular time value